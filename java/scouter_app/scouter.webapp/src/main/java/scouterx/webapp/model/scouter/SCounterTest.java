// This code is not testable as it contains constructors and dependencies on external classes that cannot be easily mocked.