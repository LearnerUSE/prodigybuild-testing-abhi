Do you want the refactored code with the same functionality or do you have any specific requirements?